<!DOCTYPE html>

<html>
  <head>
    <title>Tic Tac Toe</title>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="It's really cool">
    <meta name="author" content="trinkey">

    <meta property="og:type" content="website">
    <meta property="og:title" content="Tic Tac Toe">
    <meta property="og:description" content="It's really cool (trust me)">
    <meta property="og:url" content="https://trinkey.web.app/">
    <meta property="og:site_name" content="trinkey.web.app">
    <meta property="og:image" content="https://trinkey.web.app/img/cat.png">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@trinkey_2">
    <meta name="twitter:title" content="Tic Tac Toe">
    <meta name="twitter:description" content="It's really cool (trust me)">
    <meta name="twitter:image" content="https://trinkey.web.app/img/cat.png">

    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/games/tictactoe.css">
    <link rel="icon" type="image/x-icon" href="/img/favicon.ico">
  </head>

  <body>
    <script src="/src/base.js"></script>

    <pre class="board center"><span id="a1">   </span>|<span id="a2">   </span>|<span id="a3">   </span>
---+---+---
<span id="b1">   </span>|<span id="b2">   </span>|<span id="b3">   </span>
---+---+---
<span id="c1">   </span>|<span id="c2">   </span>|<span id="c3">   </span></pre>

    <div id="win" class="center"></div>

    <script>
      let turn, tiles, board;

      function checkForWin() {
        let wins = [
          [0, 1, 2],
          [3, 4, 5],
          [6, 7, 8],
          [0, 3, 6],
          [1, 4, 7],
          [2, 5, 8],
          [0, 4, 8],
          [2, 4, 6]
        ];

        for (let i = 0; i < 8; i++) {
          if (
               board[wins[i][0]] == board[wins[i][1]]
            && board[wins[i][1]] == board[wins[i][2]]
            && board[wins[i][0]] != 0
          ) {
            dom("win").innerHTML = `${tiles[turn]} wins!`

            for (let i = 0; i < 9; i++) {
              document.getElementsByTagName("span")[i].removeEventListener("click", clickHandler)
            }

            return;
          }
        }

        let tie = true;

        for (let i = 0; i < 3; i++) {
          for (let o = 0; o < 3; o++) {
            if (!board[i * 3 + o]) {
              tie = false;
            }
          }
        }

        if (tie) {
          dom("win").innerHTML = "Tie! No winners!";
          return;
        }
      }

      function clickHandler() {
        this.removeEventListener("click", clickHandler)
        this.innerHTML = tiles[turn];

        board[({"a": -1, "b": 2, "c": 5})[this.id[0]] + Number(this.id[1])] = turn + 1;
        checkForWin();

        turn += 1;
        turn %= 2;
      }

      function start() {
        document.getElementById("a1").innerHTML = "   ";
        document.getElementById("a2").innerHTML = "   ";
        document.getElementById("a3").innerHTML = "   ";
        document.getElementById("b1").innerHTML = "   ";
        document.getElementById("b2").innerHTML = "   ";
        document.getElementById("b3").innerHTML = "   ";
        document.getElementById("c1").innerHTML = "   ";
        document.getElementById("c2").innerHTML = "   ";
        document.getElementById("c3").innerHTML = "   ";
        document.getElementById("win").innerHTML = "   ";

        turn = 0,
        tiles = [" X ", " O "],
        board = [
          0, 0, 0,
          0, 0, 0,
          0, 0, 0
        ];

        for (let i = 0; i < 9; i++) {
          document.getElementsByTagName("span")[i].addEventListener("click", clickHandler)
        }
      }
      start();

      document.onkeydown = function(e) { if (e.key == "r") { start(); }}
    </script>
  </body>
</html>