<!DOCTYPE html>

<html>
  <head>
    <title>Pronoun Tracker</title>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="It's really cool">
    <meta name="author" content="trinkey">

    <meta property="og:type" content="website">
    <meta property="og:title" content="Pronoun Tracker">
    <meta property="og:description" content="It's really cool (trust me)">
    <meta property="og:url" content="https://trinkey.web.app/">
    <meta property="og:site_name" content="trinkey.web.app">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@trinkey_2">
    <meta name="twitter:title" content="Pronoun Tracker">
    <meta name="twitter:description" content="It's really cool (trust me)">

    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/other/pronoun.css">
    <link rel="icon" type="image/x-icon" href="/img/favicon.ico">
  </head>

  <body>
    <script src="/src/base.js"></script>

    <div id="container2">
      <h1>Pronoun tracker</h1>
      <p><i>Note: this is saved in localStorage, so therefore it will only save locally on your device</i></p>
      <table id="table"><tr><th>Name</th><th>Pronouns</th><th>Other</th></tr></table>
      <p></p>
      <input placeholder="Name..." id="name">
      <input placeholder="Pronouns..." id="pronouns">
      <button id="add">Add</button><br>
      <input placeholder="Other..." id="other"><br>
    </div>

    <script>
      let pronouns = JSON.parse(localStorage.getItem("trinkey-pronouns") || `[${enableBar ? `["trinkey", "she/they", "Creator of this website"]` : ""}]`) || enableBar ? [["trinkey", "she/they", "Creator of this website"]] : [];
      const table = dom("table");
      let i = 0;

      function updateDisplay() {
        table.innerHTML = "<tr><th>Name</th><th>Pronouns</th><th>Other</th></tr>";
        i = 0;

        for (; i < pronouns.length; i++) {
          table.innerHTML += `<tr id="p${i}"><td class="name">${pronouns[i][0]}</td><td class="pronouns">${pronouns[i][1]}</td><td class="other">${pronouns[i][2]}</td></tr>`;
        }

        [...document.getElementsByTagName("tr")].forEach(function(value, index) {
          index != 1 && index && (() => { value.addEventListener("click", removeItem) })();
        });

        localStorage.setItem("trinkey-pronouns", JSON.stringify(pronouns));
      }

      function addItem() {
        let name = dom("name").value;
        let prn = dom("pronouns").value;
        let other = dom("other").value;

        if (name && prn) {
          pronouns.push([name, prn, other]);

          dom("name").value = "";
          dom("pronouns").value = "";
          dom("other").value = "";

          updateDisplay();
        }
      }

      function removeItem() {
        if ((prompt("Are you sure you want to delete this? (type 'yes' to confirm)") || "").toLowerCase() == "yes") {
          pronouns.splice(this.id[1], 1);
          updateDisplay();
        }
      }

      dom("add").addEventListener("click", addItem);
      updateDisplay();
    </script>
  </body>
</html>
